<!DOCTYPE html>
<html lang="pt-BR">
 <head>
     <meta charset="UTF-8"/>
    <title>fabriciofragoso00.github.io/index.html</title>
 </head>
 <body>
  
  <h1>Exercícios PDI  Unidade 2</h1>
  <span id="author" class="author">Fabricio Fragoso Santos &lt;fabriciofragoso55@gmail.com&gt;</span><br>
  
  <h2>7.2 Filtro homomórfico </h2>
  
  <p>Este algoritmo tem como objetivo usar o exemplo da DFT para criar um filtro Homomórfico. É útil na melhora da aparência de imagens
   através de compressão de intervalo de brilho e realce de contraste simultâneos.</p>
 
 <p>Código Fonte:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cpp"><span class="tok-cp">#include &lt;iostream&gt;</span>
<span class="tok-cp">#include &lt;opencv2/opencv.hpp&gt;</span>
<span class="tok-cp">#include &lt;opencv2/imgproc/imgproc.hpp&gt;</span>

<span class="tok-cp">#define gamaL_slider_max 100</span>
<span class="tok-cp">#define gamaH_slider_max 100</span>
<span class="tok-cp">#define d_slider_max     100</span>
<span class="tok-cp">#define c_slider_max     100</span>

<span class="tok-k">using</span> <span class="tok-k">namespace</span> <span class="tok-n">cv</span><span class="tok-p">;</span>
<span class="tok-k">using</span> <span class="tok-k">namespace</span> <span class="tok-n">std</span><span class="tok-p">;</span>

<span class="tok-n">Mat</span> <span class="tok-n">image</span><span class="tok-p">,</span> <span class="tok-n">padded</span><span class="tok-p">,</span> <span class="tok-n">imagegray</span><span class="tok-p">,</span> <span class="tok-n">tmp</span><span class="tok-p">,</span> <span class="tok-n">filtrada</span><span class="tok-p">,</span> <span class="tok-n">complexImage</span><span class="tok-p">,</span> <span class="tok-n">res</span><span class="tok-p">;</span>
<span class="tok-n">Mat_</span><span class="tok-o">&lt;</span><span class="tok-kt">float</span><span class="tok-o">&gt;</span> <span class="tok-n">realInput</span><span class="tok-p">,</span> <span class="tok-n">zeros</span><span class="tok-p">;</span>
<span class="tok-n">vector</span><span class="tok-o">&lt;</span><span class="tok-n">Mat</span><span class="tok-o">&gt;</span> <span class="tok-n">planos</span><span class="tok-p">;</span>

<span class="tok-kt">int</span> <span class="tok-n">dft_M</span><span class="tok-p">,</span> <span class="tok-n">dft_N</span><span class="tok-p">,</span> <span class="tok-n">gamaL_slider</span><span class="tok-p">,</span> <span class="tok-n">gamaH_slider</span><span class="tok-p">,</span> <span class="tok-n">d_slider</span><span class="tok-p">,</span> <span class="tok-n">c_slider</span><span class="tok-p">;</span>
<span class="tok-kt">float</span> <span class="tok-n">c</span><span class="tok-p">,</span> <span class="tok-n">d</span><span class="tok-p">,</span> <span class="tok-n">gamaH</span><span class="tok-p">,</span> <span class="tok-n">gamaL</span><span class="tok-p">;</span>

<span class="tok-kt">char</span> <span class="tok-n">key</span><span class="tok-p">;</span>

<span class="tok-c1">// troca os quadrantes da imagem da DFT</span>
<span class="tok-kt">void</span> <span class="tok-nf">deslocaDFT</span><span class="tok-p">(</span><span class="tok-n">Mat</span><span class="tok-o">&amp;</span> <span class="tok-n">image</span> <span class="tok-p">){</span>
  <span class="tok-n">Mat</span> <span class="tok-n">tmp</span><span class="tok-p">,</span> <span class="tok-n">A</span><span class="tok-p">,</span> <span class="tok-n">B</span><span class="tok-p">,</span> <span class="tok-n">C</span><span class="tok-p">,</span> <span class="tok-n">D</span><span class="tok-p">;</span>

  <span class="tok-c1">// se a imagem tiver tamanho impar, recorta a regiao para</span>
  <span class="tok-c1">// evitar cópias de tamanho desigual</span>
  <span class="tok-n">image</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">(</span><span class="tok-n">Rect</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">cols</span> <span class="tok-o">&amp;</span> <span class="tok-o">-</span><span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">rows</span> <span class="tok-o">&amp;</span> <span class="tok-o">-</span><span class="tok-mi">2</span><span class="tok-p">));</span>
  <span class="tok-kt">int</span> <span class="tok-n">cx</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">cols</span><span class="tok-o">/</span><span class="tok-mi">2</span><span class="tok-p">;</span>
  <span class="tok-kt">int</span> <span class="tok-n">cy</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">rows</span><span class="tok-o">/</span><span class="tok-mi">2</span><span class="tok-p">;</span>

  <span class="tok-c1">// reorganiza os quadrantes da transformada</span>
  <span class="tok-c1">// A B   -&gt;  D C</span>
  <span class="tok-c1">// C D       B A</span>
  <span class="tok-n">A</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">(</span><span class="tok-n">Rect</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">cx</span><span class="tok-p">,</span> <span class="tok-n">cy</span><span class="tok-p">));</span>
  <span class="tok-n">B</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">(</span><span class="tok-n">Rect</span><span class="tok-p">(</span><span class="tok-n">cx</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">cx</span><span class="tok-p">,</span> <span class="tok-n">cy</span><span class="tok-p">));</span>
  <span class="tok-n">C</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">(</span><span class="tok-n">Rect</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">cy</span><span class="tok-p">,</span> <span class="tok-n">cx</span><span class="tok-p">,</span> <span class="tok-n">cy</span><span class="tok-p">));</span>
  <span class="tok-n">D</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">(</span><span class="tok-n">Rect</span><span class="tok-p">(</span><span class="tok-n">cx</span><span class="tok-p">,</span> <span class="tok-n">cy</span><span class="tok-p">,</span> <span class="tok-n">cx</span><span class="tok-p">,</span> <span class="tok-n">cy</span><span class="tok-p">));</span>

  <span class="tok-c1">// A &lt;-&gt; D</span>
  <span class="tok-n">A</span><span class="tok-p">.</span><span class="tok-n">copyTo</span><span class="tok-p">(</span><span class="tok-n">tmp</span><span class="tok-p">);</span>  <span class="tok-n">D</span><span class="tok-p">.</span><span class="tok-n">copyTo</span><span class="tok-p">(</span><span class="tok-n">A</span><span class="tok-p">);</span>  <span class="tok-n">tmp</span><span class="tok-p">.</span><span class="tok-n">copyTo</span><span class="tok-p">(</span><span class="tok-n">D</span><span class="tok-p">);</span>
  <span class="tok-c1">// C &lt;-&gt; B</span>
  <span class="tok-n">C</span><span class="tok-p">.</span><span class="tok-n">copyTo</span><span class="tok-p">(</span><span class="tok-n">tmp</span><span class="tok-p">);</span>  <span class="tok-n">B</span><span class="tok-p">.</span><span class="tok-n">copyTo</span><span class="tok-p">(</span><span class="tok-n">C</span><span class="tok-p">);</span>  <span class="tok-n">tmp</span><span class="tok-p">.</span><span class="tok-n">copyTo</span><span class="tok-p">(</span><span class="tok-n">B</span><span class="tok-p">);</span>
<span class="tok-p">}</span>

<span class="tok-kt">void</span> <span class="tok-nf">Filtro</span><span class="tok-p">(</span><span class="tok-kt">int</span><span class="tok-p">,</span> <span class="tok-kt">void</span><span class="tok-o">*</span><span class="tok-p">){</span>
  <span class="tok-kt">int</span> <span class="tok-n">dft_M</span><span class="tok-p">,</span> <span class="tok-n">dft_N</span><span class="tok-p">;</span>

  <span class="tok-n">dft_M</span> <span class="tok-o">=</span> <span class="tok-n">tmp</span><span class="tok-p">.</span><span class="tok-n">size</span><span class="tok-p">().</span><span class="tok-n">height</span><span class="tok-p">;</span>
  <span class="tok-n">dft_N</span> <span class="tok-o">=</span> <span class="tok-n">tmp</span><span class="tok-p">.</span><span class="tok-n">size</span><span class="tok-p">().</span><span class="tok-n">width</span><span class="tok-p">;</span>

  <span class="tok-n">gamaL</span> <span class="tok-o">=</span> <span class="tok-n">gamaL_slider</span> <span class="tok-o">/</span> <span class="tok-mf">10.0</span><span class="tok-p">;</span>
  <span class="tok-n">gamaH</span> <span class="tok-o">=</span> <span class="tok-n">gamaH_slider</span> <span class="tok-o">/</span> <span class="tok-mf">10.0</span><span class="tok-p">;</span>
  <span class="tok-n">d</span>     <span class="tok-o">=</span> <span class="tok-n">d_slider</span> <span class="tok-o">/</span> <span class="tok-mf">10.0</span><span class="tok-p">;</span>
  <span class="tok-n">c</span>     <span class="tok-o">=</span> <span class="tok-n">c_slider</span> <span class="tok-o">/</span> <span class="tok-mf">10.0</span><span class="tok-p">;</span>

  <span class="tok-c1">// prepara o filtro passa-baixas ideal</span>
  <span class="tok-k">for</span><span class="tok-p">(</span><span class="tok-kt">int</span> <span class="tok-n">i</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">;</span> <span class="tok-n">i</span><span class="tok-o">&lt;</span><span class="tok-n">dft_M</span><span class="tok-p">;</span> <span class="tok-n">i</span><span class="tok-o">++</span><span class="tok-p">){</span>
    <span class="tok-k">for</span><span class="tok-p">(</span><span class="tok-kt">int</span> <span class="tok-n">j</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">;</span> <span class="tok-n">j</span><span class="tok-o">&lt;</span><span class="tok-n">dft_N</span><span class="tok-p">;</span> <span class="tok-n">j</span><span class="tok-o">++</span><span class="tok-p">){</span>
      <span class="tok-n">tmp</span><span class="tok-p">.</span><span class="tok-n">at</span><span class="tok-o">&lt;</span><span class="tok-kt">float</span><span class="tok-o">&gt;</span> <span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">,</span><span class="tok-n">j</span><span class="tok-p">)</span> <span class="tok-o">=</span> <span class="tok-p">(</span><span class="tok-n">gamaH</span> <span class="tok-o">-</span> <span class="tok-n">gamaL</span><span class="tok-p">)</span> <span class="tok-o">*</span>
      <span class="tok-p">(</span><span class="tok-mi">1</span> <span class="tok-o">-</span> <span class="tok-n">exp</span><span class="tok-p">(</span><span class="tok-o">-</span><span class="tok-mi">1</span> <span class="tok-o">*</span> <span class="tok-n">c</span> <span class="tok-o">*</span> <span class="tok-p">(</span><span class="tok-n">pow</span><span class="tok-p">(</span><span class="tok-n">i</span> <span class="tok-o">-</span> <span class="tok-n">dft_M</span><span class="tok-o">/</span><span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">)</span> <span class="tok-o">+</span>
      <span class="tok-n">pow</span><span class="tok-p">(</span><span class="tok-n">j</span> <span class="tok-o">-</span> <span class="tok-n">dft_N</span><span class="tok-o">/</span><span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">))</span><span class="tok-o">/</span><span class="tok-n">pow</span><span class="tok-p">(</span><span class="tok-n">d</span><span class="tok-p">,</span><span class="tok-mi">2</span><span class="tok-p">)))</span> <span class="tok-o">+</span> <span class="tok-n">gamaL</span><span class="tok-p">;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">}</span>

  <span class="tok-c1">// cria a matriz com as componentes do filtro e junta</span>
  <span class="tok-c1">// ambas em uma matriz multicanal complexa</span>
  <span class="tok-n">Mat</span> <span class="tok-n">comps</span><span class="tok-p">[]</span><span class="tok-o">=</span> <span class="tok-p">{</span><span class="tok-n">tmp</span><span class="tok-p">,</span> <span class="tok-n">tmp</span><span class="tok-p">};</span>
  <span class="tok-n">merge</span><span class="tok-p">(</span><span class="tok-n">comps</span><span class="tok-p">,</span> <span class="tok-mi">2</span><span class="tok-p">,</span> <span class="tok-n">filtrada</span><span class="tok-p">);</span>
<span class="tok-p">}</span>

<span class="tok-kt">int</span> <span class="tok-nf">main</span><span class="tok-p">(</span><span class="tok-kt">int</span> <span class="tok-n">argc</span><span class="tok-p">,</span> <span class="tok-kt">char</span><span class="tok-o">**</span> <span class="tok-n">argv</span><span class="tok-p">){</span>

  <span class="tok-n">namedWindow</span><span class="tok-p">(</span><span class="tok-s">&quot;filtrada&quot;</span><span class="tok-p">,</span> <span class="tok-n">CV_WINDOW_AUTOSIZE</span><span class="tok-p">);</span>
  <span class="tok-n">createTrackbar</span><span class="tok-p">(</span><span class="tok-s">&quot;Valor gamaH&quot;</span><span class="tok-p">,</span>
                <span class="tok-s">&quot;filtrada&quot;</span><span class="tok-p">,</span>
                <span class="tok-o">&amp;</span><span class="tok-n">gamaH_slider</span><span class="tok-p">,</span>
                <span class="tok-n">gamaH_slider_max</span><span class="tok-p">,</span>
                <span class="tok-n">Filtro</span><span class="tok-p">);</span>
  <span class="tok-n">createTrackbar</span><span class="tok-p">(</span><span class="tok-s">&quot;Valor gamaL&quot;</span><span class="tok-p">,</span>
                <span class="tok-s">&quot;filtrada&quot;</span><span class="tok-p">,</span>
                <span class="tok-o">&amp;</span><span class="tok-n">gamaL_slider</span><span class="tok-p">,</span>
                <span class="tok-n">gamaL_slider_max</span><span class="tok-p">,</span>
                <span class="tok-n">Filtro</span><span class="tok-p">);</span>
  <span class="tok-n">createTrackbar</span><span class="tok-p">(</span><span class="tok-s">&quot;Valor d&quot;</span><span class="tok-p">,</span>
                <span class="tok-s">&quot;filtrada&quot;</span><span class="tok-p">,</span>
                <span class="tok-o">&amp;</span><span class="tok-n">d_slider</span><span class="tok-p">,</span>
                <span class="tok-n">d_slider_max</span><span class="tok-p">,</span>
                <span class="tok-n">Filtro</span><span class="tok-p">);</span>
  <span class="tok-n">createTrackbar</span><span class="tok-p">(</span><span class="tok-s">&quot;Valor c&quot;</span><span class="tok-p">,</span>
                <span class="tok-s">&quot;filtrada&quot;</span><span class="tok-p">,</span>
                <span class="tok-o">&amp;</span><span class="tok-n">c_slider</span><span class="tok-p">,</span>
                <span class="tok-n">c_slider_max</span><span class="tok-p">,</span>
                <span class="tok-n">Filtro</span><span class="tok-p">);</span>

  <span class="tok-c1">// carregar imagem</span>
  <span class="tok-n">image</span> <span class="tok-o">=</span> <span class="tok-n">imread</span><span class="tok-p">(</span><span class="tok-n">argv</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">],</span> <span class="tok-n">CV_LOAD_IMAGE_GRAYSCALE</span><span class="tok-p">);</span>

  <span class="tok-k">if</span><span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">data</span><span class="tok-p">){</span>
    <span class="tok-n">cout</span> <span class="tok-o">&lt;&lt;</span> <span class="tok-s">&quot;Nao abriu: &quot;</span> <span class="tok-o">&lt;&lt;</span> <span class="tok-n">argv</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span> <span class="tok-o">&lt;&lt;</span> <span class="tok-n">endl</span><span class="tok-p">;</span>
    <span class="tok-n">cout</span> <span class="tok-o">&lt;&lt;</span> <span class="tok-n">argv</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">]</span> <span class="tok-o">&lt;&lt;</span> <span class="tok-s">&quot; imagem.jpg&quot;</span><span class="tok-p">;</span>
    <span class="tok-n">exit</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">);</span>
  <span class="tok-p">}</span>

  <span class="tok-c1">// identifica os tamanhos otimos para</span>
  <span class="tok-c1">// calculo do FFT</span>
  <span class="tok-n">dft_M</span> <span class="tok-o">=</span> <span class="tok-n">getOptimalDFTSize</span><span class="tok-p">(</span><span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">rows</span><span class="tok-p">);</span>
  <span class="tok-n">dft_N</span> <span class="tok-o">=</span> <span class="tok-n">getOptimalDFTSize</span><span class="tok-p">(</span><span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">cols</span><span class="tok-p">);</span>

  <span class="tok-c1">// realiza o padding da imagem</span>
  <span class="tok-n">copyMakeBorder</span><span class="tok-p">(</span><span class="tok-n">image</span><span class="tok-p">,</span> <span class="tok-n">padded</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
                 <span class="tok-n">dft_M</span> <span class="tok-o">-</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">rows</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
                 <span class="tok-n">dft_N</span> <span class="tok-o">-</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">cols</span><span class="tok-p">,</span>
                 <span class="tok-n">BORDER_CONSTANT</span><span class="tok-p">,</span> <span class="tok-n">Scalar</span><span class="tok-o">::</span><span class="tok-n">all</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">));</span>

  <span class="tok-c1">// parte imaginaria da matriz complexa (preenchida com zeros)</span>
  <span class="tok-n">zeros</span> <span class="tok-o">=</span> <span class="tok-n">Mat_</span><span class="tok-o">&lt;</span><span class="tok-kt">float</span><span class="tok-o">&gt;::</span><span class="tok-n">zeros</span><span class="tok-p">(</span><span class="tok-n">padded</span><span class="tok-p">.</span><span class="tok-n">size</span><span class="tok-p">());</span>

  <span class="tok-c1">// prepara a matriz complexa para ser preenchida</span>
  <span class="tok-n">complexImage</span> <span class="tok-o">=</span> <span class="tok-n">Mat</span><span class="tok-p">(</span><span class="tok-n">padded</span><span class="tok-p">.</span><span class="tok-n">size</span><span class="tok-p">(),</span> <span class="tok-n">CV_32FC2</span><span class="tok-p">,</span> <span class="tok-n">Scalar</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">));</span>

  <span class="tok-c1">// a função de transferência (filtro frequencial) deve ter o</span>
  <span class="tok-c1">// mesmo tamanho e tipo da matriz complexa</span>
  <span class="tok-n">filtrada</span> <span class="tok-o">=</span> <span class="tok-n">complexImage</span><span class="tok-p">.</span><span class="tok-n">clone</span><span class="tok-p">();</span>

  <span class="tok-c1">// cria uma matriz temporária para criar as componentes real</span>
  <span class="tok-c1">// e imaginaria do filtro ideal</span>
  <span class="tok-n">tmp</span> <span class="tok-o">=</span> <span class="tok-n">Mat</span><span class="tok-p">(</span><span class="tok-n">dft_M</span><span class="tok-p">,</span> <span class="tok-n">dft_N</span><span class="tok-p">,</span> <span class="tok-n">CV_32F</span><span class="tok-p">);</span>

  <span class="tok-k">for</span><span class="tok-p">(;;){</span>
    <span class="tok-n">imagegray</span> <span class="tok-o">=</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">clone</span><span class="tok-p">();</span>
    <span class="tok-n">imshow</span><span class="tok-p">(</span><span class="tok-s">&quot;original&quot;</span><span class="tok-p">,</span> <span class="tok-n">imagegray</span><span class="tok-p">);</span>

    <span class="tok-c1">// realiza o padding da imagem</span>
    <span class="tok-n">copyMakeBorder</span><span class="tok-p">(</span><span class="tok-n">imagegray</span><span class="tok-p">,</span> <span class="tok-n">padded</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
                   <span class="tok-n">dft_M</span> <span class="tok-o">-</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">rows</span><span class="tok-p">,</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
                   <span class="tok-n">dft_N</span> <span class="tok-o">-</span> <span class="tok-n">image</span><span class="tok-p">.</span><span class="tok-n">cols</span><span class="tok-p">,</span>
                   <span class="tok-n">BORDER_CONSTANT</span><span class="tok-p">,</span> <span class="tok-n">Scalar</span><span class="tok-o">::</span><span class="tok-n">all</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">));</span>

    <span class="tok-c1">// limpa o array de matrizes que vao compor a</span>
    <span class="tok-c1">// imagem complexa</span>
    <span class="tok-n">planos</span><span class="tok-p">.</span><span class="tok-n">clear</span><span class="tok-p">();</span>
    <span class="tok-c1">// cria a compoente real</span>
    <span class="tok-n">realInput</span> <span class="tok-o">=</span> <span class="tok-n">Mat_</span><span class="tok-o">&lt;</span><span class="tok-kt">float</span><span class="tok-o">&gt;</span><span class="tok-p">(</span><span class="tok-n">padded</span><span class="tok-p">);</span>

    <span class="tok-c1">//calculando o logaritmo da imagem</span>
    <span class="tok-n">log</span><span class="tok-p">(</span><span class="tok-n">realInput</span><span class="tok-p">,</span> <span class="tok-n">realInput</span><span class="tok-p">);</span>

    <span class="tok-c1">// insere as duas componentes no array de matrizes</span>
    <span class="tok-n">planos</span><span class="tok-p">.</span><span class="tok-n">push_back</span><span class="tok-p">(</span><span class="tok-n">realInput</span><span class="tok-p">);</span>
    <span class="tok-n">planos</span><span class="tok-p">.</span><span class="tok-n">push_back</span><span class="tok-p">(</span><span class="tok-n">zeros</span><span class="tok-p">);</span>

    <span class="tok-c1">// combina o array de matrizes em uma unica</span>
    <span class="tok-c1">// componente complexa</span>
    <span class="tok-n">merge</span><span class="tok-p">(</span><span class="tok-n">planos</span><span class="tok-p">,</span> <span class="tok-n">complexImage</span><span class="tok-p">);</span>

    <span class="tok-c1">// calcula o dft</span>
    <span class="tok-n">dft</span><span class="tok-p">(</span><span class="tok-n">complexImage</span><span class="tok-p">,</span> <span class="tok-n">complexImage</span><span class="tok-p">);</span>

    <span class="tok-c1">// realiza a troca de quadrantes</span>
    <span class="tok-n">deslocaDFT</span><span class="tok-p">(</span><span class="tok-n">complexImage</span><span class="tok-p">);</span>

    <span class="tok-c1">// aplica o filtro frequencial</span>
    <span class="tok-n">mulSpectrums</span><span class="tok-p">(</span><span class="tok-n">complexImage</span><span class="tok-p">,</span><span class="tok-n">filtrada</span><span class="tok-p">,</span><span class="tok-n">complexImage</span><span class="tok-p">,</span><span class="tok-mi">0</span><span class="tok-p">);</span>

    <span class="tok-c1">// troca novamente os quadrantes</span>
    <span class="tok-n">deslocaDFT</span><span class="tok-p">(</span><span class="tok-n">complexImage</span><span class="tok-p">);</span>

    <span class="tok-c1">// calcula a DFT inversa</span>
    <span class="tok-n">idft</span><span class="tok-p">(</span><span class="tok-n">complexImage</span><span class="tok-p">,</span> <span class="tok-n">complexImage</span><span class="tok-p">,</span> <span class="tok-n">DFT_SCALE</span><span class="tok-p">);</span>

    <span class="tok-c1">// limpa o array de planos</span>
    <span class="tok-n">planos</span><span class="tok-p">.</span><span class="tok-n">clear</span><span class="tok-p">();</span>

    <span class="tok-c1">// separa as partes real e imaginaria da</span>
    <span class="tok-c1">// imagem filtrada</span>
    <span class="tok-n">split</span><span class="tok-p">(</span><span class="tok-n">complexImage</span><span class="tok-p">,</span> <span class="tok-n">planos</span><span class="tok-p">);</span>

    <span class="tok-c1">//calcular exponencial</span>
    <span class="tok-n">exp</span><span class="tok-p">(</span><span class="tok-n">planos</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">],</span> <span class="tok-n">planos</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">]);</span>

    <span class="tok-c1">// normaliza a parte real para exibicao</span>
    <span class="tok-n">normalize</span><span class="tok-p">(</span><span class="tok-n">planos</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">],</span> <span class="tok-n">planos</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">],</span> <span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-n">CV_MINMAX</span><span class="tok-p">);</span>
    <span class="tok-n">imshow</span><span class="tok-p">(</span><span class="tok-s">&quot;filtrada&quot;</span><span class="tok-p">,</span> <span class="tok-n">planos</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">]);</span>

    <span class="tok-n">key</span> <span class="tok-o">=</span> <span class="tok-p">(</span><span class="tok-kt">char</span><span class="tok-p">)</span> <span class="tok-n">waitKey</span><span class="tok-p">(</span><span class="tok-mi">10</span><span class="tok-p">);</span>
    <span class="tok-k">if</span><span class="tok-p">(</span> <span class="tok-n">key</span> <span class="tok-o">==</span> <span class="tok-mi">27</span> <span class="tok-p">)</span>
      <span class="tok-k">break</span><span class="tok-p">;</span>
  <span class="tok-p">}</span>
    <span class="tok-n">planos</span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">].</span><span class="tok-n">convertTo</span><span class="tok-p">(</span><span class="tok-n">res</span><span class="tok-p">,</span> <span class="tok-n">CV_8UC1</span><span class="tok-p">,</span> <span class="tok-mf">255.0</span><span class="tok-p">);</span>
    <span class="tok-n">imwrite</span><span class="tok-p">(</span><span class="tok-s">&quot;ImagemOriginal.png&quot;</span><span class="tok-p">,</span> <span class="tok-n">imagegray</span><span class="tok-p">);</span>
    <span class="tok-n">imwrite</span><span class="tok-p">(</span><span class="tok-s">&quot;filtrada.png&quot;</span><span class="tok-p">,</span> <span class="tok-n">res</span><span class="tok-p">);</span>

  <span class="tok-k">return</span> <span class="tok-mi">0</span><span class="tok-p">;</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div> 
 

<h2>8.3 Canny e a Arte com Pontilhismo</h2>
  
<p> O principal objetivo de um sistema de visão computacional é o desenvolvimento de mecanismos que interpretem imagens de maneira 
 eficiente. Desta forma a detecção de bordas é uma ferramenta extremamente importante no processo de análise de imagens. 
 Este trabalho tem como objetivo apresentar um dos algoritmos para detecção de bordas, o detector de bordas canny. Já o pontilhismo é 
 uma técnica de desenho impressionista onde o quadro é pintado usando apenas pontos.</p>
 
<p> O exercício consiste na utilização das bordas encontradas pelo algoritmo de Canny para o melhoramento da técnica do pontilhismo. 
 Inicialmente foi aplicado na imagem o processo de pontilhismo, e logo apos a imagem  passou por algumas iterações do filtro
 de Canny, para que fosse possível delimitar suas bordas. Em cada uma das iterações o limiar do filtro é alterado com a intenção 
 de obter uma imagem com menos bordas. <p>
 
 </body>
 </html>
